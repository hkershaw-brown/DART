#!/bin/csh
#
# DART software - Copyright UCAR. This open source software is provided
# by UCAR, "as is", without charge, subject to all terms of use at
# http://www.image.ucar.edu/DAReS/DART/DART_download
#
# DART $Id$
#
# usage: mkmf_filter [ -mpi | -nompi ]
#
# without any args, builds filter without mpi libraries, and it will run
# as a normal executable. if -mpi is given, it will be compiled with the mpi
# libraries and can run with multiple cooperating processes.

if ( $#argv > 0 ) then
  if ("$argv[1]" == "-mpi") then
    setenv usingmpi 1
  else if ("$argv[1]" == "-nompi") then
    setenv usingmpi 0
  else
    echo "Unrecognized argument to mkmf_filter: $argv[1]"
    echo "Usage: mkmf_filter [ -mpi | -nompi ]"
    echo " default is to generate a Makefile without MPI support."
    exit -1
  endif
else
  setenv usingmpi 0
endif


if ( $usingmpi ) then

  echo "Making Makefile with MPI"

  touch using_mpi_for_filter
  ../../../build_templates/mkmf -p filter -t ../../../build_templates/mkmf.template   \
        -a "../../.." -w path_names_filter ../../../src/ensemble_manager ../../../src/mpi

else

  echo "Making Makefile without MPI"
  rm -f using_mpi_for_filter
  ../../../build_templates/mkmf -d -p filter -t ../../../build_templates/mkmf.template   \
        -a "../../.." path_names_filter ../../../src/ensemble_manager ../../../src/null_mpi


endif

exit $status

# <next few lines under version control, do not edit>
# $URL$
# $Revision$
# $Date$

